/*
Mithril v0.1
http://github.com/lhorie/mithril.js
(c) Leo Horie
License: MIT
*/
!new function(a){function b(e,f,g){if(null!==f&&void 0!==f){var h=s.call(g),i=s.call(f);if(h!=i&&(null!==g&&void 0!==g&&d(g.nodes),g=new f.constructor,g.nodes=[]),"[object Array]"==i){for(var j=[],k=g.length===f.length,l=0;l<f.length;l++){var m=b(e,f[l],g[l]);m.nodes.intact||(k=!1),g[l]=m}if(!k){for(var l=0;l<f.length;l++)j=j.concat(g[l].nodes);for(var n,l=j.length;n=g.nodes[l];l++)null!==n.parentNode&&n.parentNode.removeChild(n);for(var n,l=g.nodes.length;n=j[l];l++)null===n.parentNode&&e.appendChild(n);g.length=f.length,g.nodes=j}}else if("[object Object]"==i){(f.tag!=g.tag||Object.keys(f.attrs).join()!=Object.keys(g.attrs).join())&&d(g.nodes);var n,o=0===g.nodes.length;o?(n=a.document.createElement(f.tag),g={tag:f.tag,attrs:c(n,f.attrs,{}),children:b(n,f.children,g.children),nodes:[n]},e.appendChild(n)):(n=g.nodes[0],c(n,f.attrs,g.attrs),g.children=b(n,f.children,g.children),g.nodes.intact=!0),"[object Function]"==s.call(f.attrs.config)&&f.attrs.config(n,!o)}else{var n;if(0===g.nodes.length){if(f.$trusted){var p=e.lastChild;e.insertAdjacentHTML("beforeend",f),n=p?p.nextSibling:e.firstChild}else n=a.document.createTextNode(f),e.appendChild(n);g="string number boolean".indexOf(typeof f)>-1?new f.constructor(f):f,g.nodes=[n]}else if(g.valueOf()!==f.valueOf()){if(f.$trusted){var q=g.nodes[0],j=[q];if(q){for(;q=q.nextSibling;)j.push(q);d(j);var p=e.lastChild;e.insertAdjacentHTML("beforeend",f),n=p?p.nextSibling:e.firstChild}else e.innerHTML=f}else n=g.nodes[0],e.appendChild(n),n.nodeValue=f;g=new f.constructor(f),g.nodes=[n]}else g.nodes.intact=!0}return g}}function c(a,b,c){for(var d in b){var e=b[d];if(!(d in c)||c[d]!==e){if(c[d]=e,"config"==d)continue;if(0==d.indexOf("on")&&"function"==typeof e&&(e=f(e,a)),"style"==d)for(var g in e)a.style[g]=e[g];else d in a?a[d]=e:a.setAttribute(d,e)}}return c}function d(a){for(var b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b]);a.length=0}function e(a){var b={};for(var c in a)b[c]=a[c];return b}function f(b,c){return function(){m.startComputation();var d=b.apply(c||a,arguments);return m.endComputation(),d}}function g(){if(C=a.performance&&a.performance.now?a.performance.now():(new a.Date).getTime(),C-D>16)m.redraw();else{var b=a.cancelAnimationFrame||a.clearTimeout,c=a.requestAnimationFrame||a.setTimeout;b(E),E=c(m.redraw,0)}}function h(a,b,c){for(var d in b){if(d==c)return!void m.module(a,b[d]);var e=new RegExp("^"+d.replace(/:[^\/]+/g,"([^\\/]+)")+"$");if(e.test(c))return!void c.replace(e,function(){var c=d.match(/:[^\/]+/g),e=[].slice.call(arguments,1,-2);J={};for(var f=0;f<c.length;f++)J[c[f].slice(1)]=e[f];m.module(a,b[d])})}}function i(a){a.preventDefault(),m.route(a.currentTarget.getAttribute("href"))}function j(){"hash"!=m.route.mode&&a.location.hash&&(a.location.hash=a.location.hash)}function k(a){return a}function l(b){var c=a.XDomainRequest?new a.XDomainRequest:new a.XMLHttpRequest;return c.open(b.method,b.url,!0,b.user,b.password),c.onload="function"==typeof b.onload?b.onload:function(){},c.onerror="function"==typeof b.onerror?b.onerror:function(){},c.withCredentials=!0,"function"==typeof b.config&&b.config(c,b),c.send(b.data),c}function n(a,b){var c=[];for(var d in a){var e=b?b+"["+d+"]":d,f=a[d];c.push("object"==typeof f?n(f,e):encodeURIComponent(e)+"="+encodeURIComponent(f))}return c.join("&")}function o(a,b,c){return b&&Object.keys(b).length>0&&("GET"==a.method?a.url=a.url+(a.url.indexOf("?")<0?"?":"&")+n(b):a.data=c(b)),a}function p(a,b){var c=a.match(/:\w+/g);if(c&&b)for(var d=0;d<c.length;d++){var e=c[d].slice(1);a=a.replace(c[d],b[e]),delete b[e]}return a}function q(a){var b=a.then;return function(a,c){var d=b(function(b){return d(a(b))},function(a){return d(c(a))});return d.then=q(d),d}}var r={},s={}.toString,t=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,u=/\[(.+?)(?:=("|'|)(.+?)\2)?\]/;Mithril=m=function(){var a=arguments,b="[object Object]"==s.call(a[1]),c=b?a[1]:{},d="class"in c?"class":"className",f=r[a[0]];if(void 0===f){r[a[0]]=f={tag:"div",attrs:{}};for(var g,h=[];g=t.exec(a[0]);)if(""==g[1])f.tag=g[2];else if("#"==g[1])f.attrs.id=g[2];else if("."==g[1])h.push(g[2]);else if("["==g[3][0]){var i=u.exec(g[3]);f.attrs[i[1]]=i[3]||!0}h.length>0&&(f.attrs[d]=h.join(" "))}f=e(f),f.attrs=e(f.attrs),f.children=b?a[2]:a[1];for(var j in c)f.attrs[j]=j==d?(f.attrs[j]||"")+" "+c[j]:c[j];return f};var v,w={insertAdjacentHTML:function(b,c){a.document.write(c),a.document.close()},appendChild:function(b){void 0===v&&(v=a.document.createElement("html")),"HTML"==b.nodeName?v=b:v.appendChild(b),a.document.documentElement!==v&&a.document.replaceChild(v,a.document.documentElement)}},x=[],y={};m.render=function(c,d){var e=x.indexOf(c),f=0>e?x.push(c)-1:e,g=c==a.document||c==a.document.documentElement?w:c;y[f]=b(g,d,y[f])},m.trust=function(a){return a=new String(a),a.$trusted=!0,a};var z,A={view:function(){}},B={},C=0,D=0,E=0;m.module=function(a,b){m.startComputation(),z=a,A=b,B=new b.controller,m.endComputation()},m.redraw=function(){m.render(z||a.document,A.view(B)),D=C};var F=0,G=null;m.startComputation=function(){F++},m.endComputation=function(){F=Math.max(F-1,0),0==F&&(g(),G&&(G(),G=null))},m.withAttr=function(a,b){return function(c){b(a in c.currentTarget?c.currentTarget[a]:c.currentTarget.getAttribute(a))}};var H={pathname:"",hash:"#",search:"?"},I=function(){},J={};m.route=function(){if(3==arguments.length){var b=arguments[0],c=arguments[1],d=arguments[2];I=function(a){var e=a.slice(H[m.route.mode].length);h(b,d,e)||m.route(c,!0)};var e="hash"==m.route.mode?"onhashchange":"onpopstate";a[e]=function(){I(a.location[m.route.mode])},G=j,a[e]()}else if(arguments[0].addEventListener){var f=arguments[0],g=arguments[1];g||(f.removeEventListener("click",i),f.addEventListener("click",i))}else if("string"==typeof arguments[0]){var k=arguments[0],l=arguments[1]===!0;a.history.pushState?(G=function(){a.history[l?"replaceState":"pushState"](null,a.document.title,H[m.route.mode]+k),j()},I(H[m.route.mode]+k)):a.location[m.route.mode]=k}},m.route.param=function(a){return J[a]},m.route.mode="search",m.prop=function(a){return function(){return arguments.length&&(a=arguments[0]),a}},m.deferred=function(){var a=[],b=[],c={resolve:function(b){for(var c=0;c<a.length;c++)a[c](b)},reject:function(a){for(var c=0;c<b.length;c++)b[c](a)},promise:m.prop()};return c.promise.resolvers=a,c.promise.then=function(c,d){var e=m.deferred();return c||(c=k),d||(d=k),a.push(function(a){var b=c(a);e.resolve(void 0!==b?b:a)}),b.push(function(a){var b=d(a);e.reject(void 0!==b?b:a)}),e.promise},c},m.sync=function(a){function b(b){return function(f){return e.push(f),b||(c="reject"),e.length==a.length&&(d.promise(e),d[c](e)),f}}for(var c="resolve",d=m.deferred(),e=[],f=0;f<a.length;f++)a[f].then(b(!0),b(!1));return d.promise},m.request=function(a){m.startComputation();var b=m.deferred(),c=a.serialize||JSON.stringify,d=a.deserialize||JSON.parse;return a.url=p(a.url,a.data),a=o(a,a.data,c),a.onload=a.onerror=function(c){var e=("load"==c.type?a.unwrapSuccess:a.unwrapError)||k,f=e(d(c.target.responseText));if(f instanceof Array&&a.type)for(var g=0;g<f.length;g++)f[g]=new a.type(f[g]);else a.type&&(f=new a.type(f));b.promise(f),b["load"==c.type?"resolve":"reject"](f),m.endComputation()},l(a),b.promise.then=q(b.promise),b.promise},m.deps=function(b){return a=b}}(this);
//# sourceMappingURL=mithril.min.map